!function(){function c(){var e=document.getElementById(r);return null==e&&((e=document.createElement("div")).id=r,document.body.appendChild(e)),e}function a(e,t,n,r){var o=document.createElement("div");for(var i in o.style.position="absolute",t?t.appendChild(o):c().appendChild(o),o.setAttribute("id",e),n&&(o.className=n),o.style.left=Math.floor(1e3*Math.random())+"px",o.style.top=Math.floor(1e3*Math.random())+"px",l.push({id:e,el:o}),r=r||{})o.style[i]=r[i];return o}function t(e){!function(e){e=null==e.length&&"string"!=typeof e?[e]:e;for(var t=0;t<e.length;t++){var n="string"==typeof e[t]?document.getElementById(e[t]):e[t];n.parentNode&&n.parentNode.removeChild(n)}}(document.querySelectorAll(e))}function g(e,t){var n=t.getBoundingClientRect(),r=e.getJsPlumb().getSize(t),o=n.x+r[0]/2,i=n.y+r[1]/2;return m(o,i)}function n(e,t){var n=e.getJsPlumb();n.trigger(t,"mousedown",g(e,t));for(var r,o,i=50*Math.random(),c=0;c<i;c++){var a=(void 0,r=parseInt(2e3*Math.random()),o=parseInt(2e3*Math.random()),m(r,o));t.style.left=a.screenX+"px",t.style.top=a.screenY+"px",n.trigger(document,"mousemove",a)}n.trigger(document,"mouseup",p)}function s(e,t,n){var r=a("div");r.style.position="absolute",r.style.left="0px",r.style.top="0px",r.style.width=(n&&n.width?n.width:500)+"px",r.style.height=(n&&n.height?n.height:500)+"px";var o=jsPlumb.extend({container:r},t),i=e.render(o);return{surface:i,container:r,jsplumb:i.getJsPlumb()}}function u(e,t,n,r){var o=e.getJsPlumb(),i=g(e,t);o.trigger(t,f,i);var c=o.getSize(t),a=e.getApparentCanvasLocation(),u=e.getJsPlumb().getContainer().parentNode.getBoundingClientRect(),s=u.x+a[0],l=u.y+a[1];o.trigger(document,h,m(Math.floor(n+s+c[0]/2),Math.floor(r+l+c[1]/2))),o.trigger(document,v)}function o(e,t,n,r){var o=e.getJsPlumb(),i=g(e,t);o.trigger(t,f,i),o.trigger(document,h,function(e,t,n){return{clientX:e.clientX+t,clientY:e.clientY+n,screenX:e.screenX+t,screenY:e.screenY+n,pageX:e.pageX+t,pageY:e.pageY+n}}(i,n,r)),o.trigger(document,v)}function i(e,t,n){e.clientX+=t,e.clientY+=n,e.screenX+=t,e.screenY+=n,e.pageX+=t,e.pageY+=n}var r="jtk-test-support-container",l=[],d=[],p={clientX:5e4,clientY:5e4,screenX:5e4,screenY:5e4,pageX:5e4,pageY:5e4},e="ontouchstart"in document.documentElement,f=e?"touchstart":"mousedown",h=e?"touchmove":"mousemove",v=e?"touchend":"mouseup",m=function(e,t){return{clientX:e,clientY:t,screenX:e,screenY:t,pageX:e,pageY:t}};window.jsPlumbToolkitTestSupport={addDiv:a,addDivs:function(e,t){for(var n=0;n<e.length;n++)a(e[n],t)},cleanup:function(){for(var e=0;e<l.length;e++)l[e].el.parentNode.removeChild(l[e].el);l.length=0,t("circle"),t(".jtk-node"),t(".jtk-surface-canvas"),t("svg"),t(".jtk-lasso"),c().innerHTML=""},delta:function(e,t,n){return e="string"==typeof e?parseFloat(e.substring(0,e.length-2)):e,t="string"==typeof t?parseFloat(t.substring(0,t.length-2)):t,Math.abs(t-e)<(n||5e-4)},DOWN_EVENT:f,UP_EVENT:v,MOVE_EVENT:h,isTouchDevice:e,makeEvent:g,makeEventAt:m,nudgeEvent:i,attachToSurface:function(e){return new y(e.getToolkit(),e)},create:function(e,t,n){var r=function(e,t,n){var r,o,i,c=jsPlumbToolkit.newInstance(e);if(null!=t){var a=s(c,t,n);o=a.container,r=a.surface,i=a.jsplumb}var u={toolkit:c,surface:r,container:o,jsplumb:i};return d.push(u),u}(e,t,n);return new y(r.toolkit,r.surface)}};var y=function(e,t){this.toolkit=e;var r=t;this.eventManager=new Mottle,Object.defineProperty(this,"surface",{get:function(){if(null==r)throw new Error("Test harness not rendered. Use `render` method or provide render params in constructor");return r}}),Object.defineProperty(this,"jsplumb",{get:function(){return this.surface.getJsPlumb()}}),Object.defineProperty(this,"container",{get:function(){return this.jsplumb.getContainer()}}),this.render=function(e,t){var n=s(this.toolkit,e,t);return r=n.surface}};y.prototype.addMiniview=function(e){e=e||{};var t=a("div");return t.style.position="absolute",t.style.left="0px",t.style.top="0px",t.style.width=(e&&e.width?e.width:250)+"px",t.style.height=(e&&e.height?e.height:250)+"px",e.container=t,this.surface.createMiniview(e)},y.prototype.querySelectorAll=function(e){return this.container.querySelectorAll(e)},y.prototype.dragANodeAround=function(e){n(this.surface,this.surface.getObjectInfo(e).el)},y.prototype.dragAnElementAround=function(e){n(this.surface,e)},y.prototype.dragConnection=function(e,t,n){var r=this.surface.getObjectInfo(e),o=this.surface.getObjectInfo(t),i="Port"===r.type&&this.surface.getRenderedEndpoint(r.obj)||r.el,c="Port"===o.type&&this.surface.getRenderedEndpoint(o.obj)||o.el;if(r.el&&o.el)!function(e,t,n,r){var o=e.getJsPlumb(),i=t.canvas||t,c=n.canvas||n,a=g(e,i),u=g(e,c);r=r||{};var s=o.select().length;r.start&&r.start(),o.trigger(i,f,a),r.down&&r.down(),o.trigger(document,h,u),r.move&&r.move(),o.trigger(c,v,u),r.up&&r.up(),o.select().get(s)}(this.surface,i,c,n);else{if(null==r.el)throw new Error(e+" cannot be resolved");if(null==o.el)throw new Error(t+" cannot be resolved")}},y.prototype.load=function(e){return this.toolkit.load(e)},y.prototype.clear=function(){return this.toolkit.clear()},y.prototype.getRenderedElement=function(e){return this.surface.getObjectInfo(e).el},y.prototype.getRenderedConnection=function(e){return this.surface.getRenderedConnection(e)},y.prototype.dragNodeIntoGroup=function(e,t){var n=this.surface.getObjectInfo(e),r=this.surface.getObjectInfo(t);if(n.el&&r.el){var o=r.el.querySelector("[jtk-group-content]")||r.el,i=this.jsplumb.getOffset(o),c=this.jsplumb.getSize(o);u(this.surface,n.el,i.left+c[0]/2,i.top+c[1]/2)}},y.prototype.getGroup=function(e){return this.getToolkitObject(e)},y.prototype.getNode=function(e){return this.getToolkitObject(e)},y.prototype.getToolkitObject=function(e){return this.surface.getObjectInfo(e).obj},y.prototype.dragNodeTo=function(e,t,n){var r=this.surface.getObjectInfo(e);if(!r.el)throw new Error("Cannot drag node: cannot resolve "+e);u(this.surface,r.el,t,n)},y.prototype.dragNodeBy=function(e,t,n){var r=this.surface.getObjectInfo(e);if(!r.el)throw new Error("Cannot drag node: cannot resolve "+e);o(this.surface,r.el,t,n)},y.prototype.dragElementBy=function(e,t,n){o(this.surface,e,t,n)},y.prototype.connect=function(e,t,n){var r=this.surface.getObjectInfo(e),o=this.surface.getObjectInfo(t);return this.toolkit.connect({source:r.obj,target:o.obj,data:n||{}})},y.prototype.dragGroupTo=y.prototype.dragNodeTo,y.prototype.trigger=function(e,t,n){var r=this.surface.getObjectInfo(e);if(!r.el)throw new Error("Trigger: Cannot resolve "+e);n=n||g(this.surface,r.el),this.jsplumb.trigger(r.el,"mousemove",n)},y.prototype.makeEvent=function(e,t,n){var r=this.surface.getObjectInfo(e);if(r.el){var o=g(this.surface,r.el);return t||n?i(o,null==t?0:t,null==n?0:n):o}throw new Error("Trigger: Cannot resolve "+e)},y.prototype.getEdge=function(e){return this.toolkit.getEdge(e)},y.prototype.updateEdge=function(e,t){this.toolkit.updateEdge(e,t)},y.prototype.getAllEdges=function(){return this.toolkit.getAllEdges()},y.prototype.getRenderedPort=function(e){return this.surface.getRenderedPort(e)},y.prototype.addNode=function(e){return this.toolkit.addNode(e)},y.prototype.updateNode=function(e,t){return this.toolkit.updateNode(e,t)},y.prototype.clickOnNode=function(e){!function(e,t){var n=e.toolkit.getNode(t),r=e.surface.getRenderedElement(n),o=g(e.surface,r);e.jsplumb.trigger(r,"click",o)}(this,e)},y.prototype.clickOnElementInsideNode=function(e,t){!function(e,t,n){var r=e.toolkit.getNode(t),o=e.surface.getRenderedElement(r),i=o.querySelector(n);if(!i)throw new Error("could not find element inside node with selector ["+n+"]");var c=g(e.surface,i);e.jsplumb.trigger(o,"click",c)}(this,e,t)},y.prototype.clickOnEdge=function(e){!function(e,t){var n=e.surface.getRenderedConnection(t),r=g(e.surface,n.canvas);e.jsplumb.trigger(n.canvas.querySelector("path"),"click",r)}(this,e)},y.prototype.clickOnOverlay=function(e,t){!function(e,t,n){var r=e.surface.getRenderedConnection(t).getOverlay(n||"lbl"),o=g(e.surface,r.canvas);e.jsplumb.trigger(r.canvas,"click",o)}(this,e,t)},y.prototype.clickOnPort=function(e,t){!function(e,t,n){var r=e.toolkit.getNode(t).getPort(n);if(r){var o=e.surface.getRenderedEndpoint(r)||e.surface.getRenderedElement(r),i=g(e.surface,o.canvas||o);e.jsplumb.trigger(o.canvas||o,"click",i)}}(this,e,t)},y.prototype.getEdgeCount=function(){return this.toolkit.getEdgeCount()},y.prototype.configureUndoRedo=function(e){return(e=jsPlumb.extend(e||{})).surface=this.surface,this.undoManager=new jsPlumbToolkitUndoRedo(e),this.undoManager},y.prototype.dragElementToCanvas=function(e,t,n){t=t||250,n=n||250;var r=this.surface.getApparentCanvasLocation(),o=this.jsplumb.getContainer().parentNode.getBoundingClientRect(),i=o.x+r[0],c=o.y+r[1],a=g(this.surface,e);this.eventManager.trigger(e,f,a);var u=this.jsplumb.getSize(e),s=this.jsplumb.getContainer().parentNode,l=e.getBoundingClientRect();this.eventManager.trigger(s,h,m(l.x+1,l.y+1)),this.eventManager.trigger(s,h,m(t+i+u[0]/2,n+c+u[1]/2)),this.eventManager.trigger(s,v)}}();