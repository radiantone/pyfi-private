(function(){var a=(i.convertToPixels=function(t,n){var e=n===i.Units.INCHES?i.PIXELS_PER_INCH:i.PIXELS_PER_CENTIMETRE;return t.map(function(t){return t*e})},i.convertToUnits=function(t,n){var e=n===i.Units.INCHES?i.PIXELS_PER_INCH:i.PIXELS_PER_CENTIMETRE;return t.map(function(t){return t/e})},i.scaleToFullPage=function(t,n,e){if(void 0===n&&(n=this.EmptyMargins),void 0===e&&(e="CENTIMETERS"),null!=this.printHandlers[t])return JSON.stringify(this.printHandlers[t].scaleToFullPage(n,e))},i.scaleToPageSize=function(t,n,e,i){if(void 0===e&&(e=this.EmptyMargins),void 0===i&&(i="CENTIMETERS"),null!=this.printHandlers[t])return JSON.stringify(this.printHandlers[t].scaleToPageSize(n,e,i))},i.scaleToPageDimensions=function(t,n,e,i){if(void 0===e&&(e=this.EmptyMargins),void 0===i&&(i="CENTIMETERS"),null!=this.printHandlers[t])return this.printHandlers[t].scaleToPageDimensions(n,e,i)},i.findElementBounds=function(n){try{if(void 0===n.offsetLeft)return{l:t=parseFloat(n.style.left),t:e=parseFloat(n.style.top),l1:t+parseFloat(n.getAttribute("width")),t1:e+parseFloat(n.getAttribute("height"))};var t=n.offsetLeft,e=n.offsetTop,i=n.offsetWidth,r=n.offsetHeight;return-1!==n.className.indexOf("jtk-overlay")&&(t-=i/2,e-=r/2),{l:t,t:e,l1:t+i,t1:e+r}}catch(t){return console.log("Cannot compute bounds for elements "+n),{l:0,l1:0,t:0,t1:0}}},i.findSurfaceBounds=function(t){var e=this;function i(t,n){isNaN(t)||n.push(t)}t.relayout(null);var r=[],s=[],o=[],a=[],n=t.getJsPlumb().getContainer().querySelectorAll(".jtk-overlay,.jtk-node,.jtk-endpoint,.jtk-group,.jtk-connector");n.forEach(function(t){var n=e.findElementBounds(t);i(n.l,r),i(n.t,o),i(n.l1,s),i(n.t1,a)});var l=Math.min.apply(null,r),u=Math.max.apply(null,s),c=Math.min.apply(null,o),f=Math.max.apply(null,a);return{x:l,y:c,w:u-l,h:f-c,padding:null,vw:u+(l<0?-l:0),vh:f+(c<0?-c:0),z:null,zoom:null}},i.scaleToBounds=function(t,n,e){if(void 0===e&&(e=this.EmptyMargins),null!=this.printHandlers[t])return this.printHandlers[t].scaleToBounds(n,e)},i.registerHandler=function(t,n){var e=new r(t,n);return this.printHandlers[e.id]=e},i.isReadyToPrint=function(t){return null!=this.printHandlers[t]&&this.printHandlers[t].isReadyToPrint()},i.PIXELS_PER_CENTIMETRE=(i.PIXELS_PER_INCH=96)/2.54,i.EmptyMargins=[0,0,0,0],i.PAGE_DIMENSIONS={LETTER:[21.59,27.94],A5:[14.8,21],A4:[21,29.7],A3:[29.7,42],A2:[42,59.4],A1:[59.4,84.1],A0:[84.1,118.9]},i.printHandlers={},i.Units={INCHES:"INCHES",CENTIMETERS:"CENTIMETERS"},i.PageSizes={FULL:"FULL",LETTER:"LETTER",A5:"A5",A4:"A4",A3:"A3",A2:"A2",A1:"A1",A0:"A0"},i);function i(){}var r=(t.prototype.scaleToBounds=function(t,n){void 0===n&&(n=a.EmptyMargins);var e=a.findSurfaceBounds(this.surface),i=t[0]-n[3]-n[1],r=t[1]-n[0]-n[2],s=Math.min(i/e.w,r/e.h),o=this.surface.isClamping();return this.surface.setClamping(!1),this.surface.setZoom(s),this.surface.setPan(-e.x*s,-e.y*s),this.surface.setClamping(o),s},t.prototype.scaleToPageDimensions=function(t,n,e){return void 0===n&&(n=a.EmptyMargins),void 0===e&&(e="CENTIMETERS"),this.scaleToBounds(a.convertToPixels(t,e),a.convertToPixels(n,e))},t.prototype.scaleToPageSize=function(t,n,e){if(void 0===n&&(n=a.EmptyMargins),void 0===e&&(e="CENTIMETERS"),"FULL"===t)return this.scaleToFullPage(n,e);var i=a.PAGE_DIMENSIONS[t];if(i){var r=a.convertToPixels(i,a.Units.CENTIMETERS),s=a.convertToPixels(n,e);return this.scaleToBounds(r,s),a.convertToUnits(r,e)}throw new Error("Unknown page size "+t)},t.prototype.scaleToFullPage=function(t,n){void 0===t&&(t=a.EmptyMargins),void 0===n&&(n="CENTIMETERS");var e=a.findSurfaceBounds(this.surface),i=[e.w+5,e.h+5],r=a.convertToPixels(t,n),s=a.convertToUnits([i[0]+r[1]+r[3],i[1]+r[0]+r[2]],n),o=this.surface.isClamping();return this.surface.setClamping(!1),this.surface.setZoom(1),this.surface.setPan(-e.x,-e.y),this.surface.setClamping(o),s},t.prototype.isReadyToPrint=function(){for(var t=this.surface.getJsPlumb().getContainer().querySelectorAll("img"),n=0;n<t.length;n++)if(!t[n].complete)return!1;return!0},t);function t(t,n){this.surface=t,this.id=n||jsPlumbUtil.uuid()}this.jsPlumbToolkitPrint=a,"undefined"!=typeof exports&&(exports.jsPlumbToolkitPrint=a)}).call("undefined"!=typeof window?window:this);